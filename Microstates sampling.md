<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Microstates sampling</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__left">
    <div class="stackedit__toc">
      
<ul>
<li><a href="#microstate-sampling">Microstate Sampling</a>
<ul>
<li><a href="#canonical-ensemble-of-microstates">Canonical Ensemble of microstates</a></li>
<li><a href="#break-down-the-energy-calculation">Break down the energy calculation</a></li>
<li><a href="#monte-carlo-sampling-challenges">Monte Carlo sampling challenges</a></li>
<li><a href="#script-to-calculate-state-energy-from-a-microstate">Script to calculate state energy from a microstate</a></li>
<li><a href="#what-else-do-we-want-to-know">What else do we want to know?</a></li>
<li><a href="#global-optimization-by-local-equilibrium-sampling-goles">Global Optimization by Local Equilibrium Sampling (GOLES)</a></li>
<li><a href="#find-linked-conformation-change">Find linked conformation change</a></li>
<li><a href="#picture-the-energy-landscape">Picture the energy landscape</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
  <div class="stackedit__right">
    <div class="stackedit__html">
      <h1 id="microstate-sampling">Microstate Sampling</h1>
<p>Problem, Challenge and Solution?</p>
<h2 id="canonical-ensemble-of-microstates">Canonical Ensemble of microstates</h2>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a0/Ensemble_quantum_1DOF_canonical.png" alt="pic"><br>
The relative population of each state:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>E</mi><mi mathvariant="normal">/</mi><mi>k</mi><mi>T</mi></mrow></msup></mrow><annotation encoding="application/x-tex">
P_{i} = e^{-E/kT}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.938em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.938em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathit mtight" style="margin-right: 0.05764em;">E</span><span class="mord mtight">/</span><span class="mord mathit mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathit mtight" style="margin-right: 0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="break-down-the-energy-calculation">Break down the energy calculation</h2>
<p>A system is broken down in to fixed and flexible parts. flexible parts consist of conformers that are selected during energy sampling.</p>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-kSK2wXU0Ff7wpFU9" width="100%" style="max-width: 747.203125px;" viewBox="0 0 747.203125 1404.359375"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M123.69905598958334,818.90625L169.015625,793.90625L194.015625,793.90625" marker-end="url(#arrowhead8039)" style="fill:none"></path><defs><marker id="arrowhead8039" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M123.69905598958334,864.90625L169.015625,889.90625L197.703125,889.90625" marker-end="url(#arrowhead8040)" style="fill:none"></path><defs><marker id="arrowhead8040" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M272.08349609375,866.90625L308.375,841.90625L333.375,841.90625" marker-end="url(#arrowhead8041)" style="fill:none"></path><defs><marker id="arrowhead8041" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M272.08349609375,912.90625L308.375,937.90625L336.9296875,937.90625" marker-end="url(#arrowhead8042)" style="fill:none"></path><defs><marker id="arrowhead8042" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M396.3999259315822,914.90625L478.3125,298.453125L503.3125,298.453125" marker-end="url(#arrowhead8043)" style="fill:none"></path><defs><marker id="arrowhead8043" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M554.6472188514858,275.453125L616.75,74.7265625L641.75,74.7265625" marker-end="url(#arrowhead8044)" style="fill:none"></path><defs><marker id="arrowhead8044" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M564.1149088541666,275.453125L616.75,202.453125L641.75,202.453125" marker-end="url(#arrowhead8045)" style="fill:none"></path><defs><marker id="arrowhead8045" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M591.75,298.453125L616.75,298.453125L641.75,298.453125" marker-end="url(#arrowhead8046)" style="fill:none"></path><defs><marker id="arrowhead8046" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M564.1149088541666,321.453125L616.75,394.453125L641.75,394.453125" marker-end="url(#arrowhead8047)" style="fill:none"></path><defs><marker id="arrowhead8047" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M555.8230794270834,321.453125L616.75,490.453125L641.75,490.453125" marker-end="url(#arrowhead8048)" style="fill:none"></path><defs><marker id="arrowhead8048" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M406.9539134973748,914.90625L478.3125,794.31640625L503.3125,794.31640625" marker-end="url(#arrowhead8049)" style="fill:none"></path><defs><marker id="arrowhead8049" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M555.1902806879898,771.31640625L616.75,586.453125L641.75,586.453125" marker-end="url(#arrowhead8050)" style="fill:none"></path><defs><marker id="arrowhead8050" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M561.7631877029717,771.31640625L616.75,682.453125L641.75,682.453125" marker-end="url(#arrowhead8051)" style="fill:none"></path><defs><marker id="arrowhead8051" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M591.75,804.4502856941309L616.75,810.1796875L641.75,810.1796875" marker-end="url(#arrowhead8052)" style="fill:none"></path><defs><marker id="arrowhead8052" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M558.6186027571479,817.31640625L616.75,937.90625L641.75,937.90625" marker-end="url(#arrowhead8053)" style="fill:none"></path><defs><marker id="arrowhead8053" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M405.56845372632864,960.90625L478.3125,1097.76953125L531.8671875,1097.76953125" marker-end="url(#arrowhead8054)" style="fill:none"></path><defs><marker id="arrowhead8054" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M399.45610186316435,960.90625L478.3125,1257.6328125L503.4921875,1257.6328125" marker-end="url(#arrowhead8055)" style="fill:none"></path><defs><marker id="arrowhead8055" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M554.6472188514858,1234.6328125L616.75,1033.90625L641.75,1033.90625" marker-end="url(#arrowhead8056)" style="fill:none"></path><defs><marker id="arrowhead8056" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M564.1149088541666,1234.6328125L616.75,1161.6328125L641.75,1161.6328125" marker-end="url(#arrowhead8057)" style="fill:none"></path><defs><marker id="arrowhead8057" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M591.5703125,1277.8182112373024L616.75,1289.359375L641.75,1289.359375" marker-end="url(#arrowhead8058)" style="fill:none"></path><defs><marker id="arrowhead8058" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M559.9956209095358,1280.6328125L616.75,1385.359375L641.75,1385.359375" marker-end="url(#arrowhead8059)" style="fill:none"></path><defs><marker id="arrowhead8059" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(82.0078125,841.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-62.0078125" y="-23" width="124.015625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-52.0078125,-13)"><foreignObject width="104.015625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Protein system</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(238.6953125,793.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-44.6796875" y="-23" width="89.359375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.6796875,-13)"><foreignObject width="69.359375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Backbone</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(238.6953125,889.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-40.9921875" y="-23" width="81.984375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-30.9921875,-13)"><foreignObject width="61.984375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Residues</div></foreignObject></g></g></g><g class="node" id="D" transform="translate(393.34375,841.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-59.96875" y="-23" width="119.9375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-49.96875,-13)"><foreignObject width="99.9375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Fixed residues</div></foreignObject></g></g></g><g class="node" id="E" transform="translate(393.34375,937.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-56.4140625" y="-23" width="112.828125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-46.4140625,-13)"><foreignObject width="92.828125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Free residues</div></foreignObject></g></g></g><g class="node" id="F1" transform="translate(547.53125,298.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-44.21875" y="-23" width="88.4375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.21875,-13)"><foreignObject width="68.4375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Residue 1</div></foreignObject></g></g></g><g class="node" id="G11" transform="translate(696.4765625,74.7265625)" style="opacity: 1;"><circle x="-54.7265625" y="-23" r="54.7265625"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 1</div></foreignObject></g></g></g><g class="node" id="G12" transform="translate(696.4765625,202.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 2</div></foreignObject></g></g></g><g class="node" id="G13" transform="translate(696.4765625,298.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 3</div></foreignObject></g></g></g><g class="node" id="G14" transform="translate(696.4765625,394.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 4</div></foreignObject></g></g></g><g class="node" id="G15" transform="translate(696.4765625,490.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 5</div></foreignObject></g></g></g><g class="node" id="F2" transform="translate(547.53125,794.31640625)" style="opacity: 1;"><rect rx="5" ry="5" x="-44.21875" y="-23" width="88.4375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.21875,-13)"><foreignObject width="68.4375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Residue 2</div></foreignObject></g></g></g><g class="node" id="G21" transform="translate(696.4765625,586.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 1</div></foreignObject></g></g></g><g class="node" id="G22" transform="translate(696.4765625,682.453125)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 2</div></foreignObject></g></g></g><g class="node" id="G23" transform="translate(696.4765625,810.1796875)" style="opacity: 1;"><circle x="-54.7265625" y="-23" r="54.7265625"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 3</div></foreignObject></g></g></g><g class="node" id="G24" transform="translate(696.4765625,937.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 4</div></foreignObject></g></g></g><g class="node" id="F3" transform="translate(547.53125,1097.76953125)" style="opacity: 1;"><rect rx="5" ry="5" x="-15.6640625" y="-23" width="31.328125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-5.6640625,-13)"><foreignObject width="11.328125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">...</div></foreignObject></g></g></g><g class="node" id="F4" transform="translate(547.53125,1257.6328125)" style="opacity: 1;"><rect rx="5" ry="5" x="-44.0390625" y="-23" width="88.078125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-34.0390625,-13)"><foreignObject width="68.078125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Residue n</div></foreignObject></g></g></g><g class="node" id="G41" transform="translate(696.4765625,1033.90625)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 1</div></foreignObject></g></g></g><g class="node" id="G42" transform="translate(696.4765625,1161.6328125)" style="opacity: 1;"><circle x="-54.7265625" y="-23" r="54.7265625"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 2</div></foreignObject></g></g></g><g class="node" id="G43" transform="translate(696.4765625,1289.359375)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 3</div></foreignObject></g></g></g><g class="node" id="G44" transform="translate(696.4765625,1385.359375)" style="opacity: 1;"><rect rx="5" ry="5" x="-54.7265625" y="-23" width="109.453125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-44.7265625,-13)"><foreignObject width="89.453125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Conformer 4</div></foreignObject></g></g></g></g></g></g></svg></div>
<h3 id="a-microstate-is-a-complete-combination-of-conformers-from-each-residue.">A microstate is a complete combination of conformers from each residue.</h3>
<p>For a complete microstate, energy includes the following two parts:</p>
<ol>
<li>The sum of self energies of selected conformers</li>
<li>The pairwise interactions bewteen selected conformers</li>
</ol>
<p>The actual Monte Carlo sampling is a bit different, for efficiency reason. Some residues don’t have a choice of conformers, either because they are defined as this in head3.lst or the reduction sampling determines so. The become fixed residues. Therefore the <strong>reduced microstate</strong> is a reduced set of conformer selection. To make the state energy comparable with a <strong>complete microstate</strong> energy, the interaction between fixed residues should also be included.</p>
<ol>
<li>The sum of self energies of selected conformers in the reduced microstate.</li>
<li>The interaction between selected conformers to fixed conformers.</li>
<li>The interaction of pairwise interaction between selected conformers.</li>
<li>The interaction between fixed conformers.</li>
</ol>
<p>What if we derive a compelete microstate from reduced microstate and just calculate a base state energy? Say residue x has conformer 6,7,8 fixed as occupancy 1, 0, 0<br>
[0, 5, 9,13, 17] -&gt; [0, 5, 6, 9, 13, 17]</p>
<p>It will work in the above example, but MCCE was designed to accept fixed partial occupancy. That is, the fixed occupancy of conformer 6, 7, 8 could be 0.5, 0.25, 0.25. In this situation, the reduced microstate can not be recovered to a complete state.</p>
<p>So we have to calculate the four terms outlined above to make microstate energy comparable.</p>
<h2 id="monte-carlo-sampling-challenges">Monte Carlo sampling challenges</h2>
<h3 id="size">Size:</h3>
<p>When the system gets bigger, the number of total possible microstates grow exponentially.</p>
<p>Roughly, we have <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>N</mi><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>=</mo><msup><mi>m</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">N_{states} = m^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathit" style="margin-right: 0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.280556em;"><span class="" style="top: -2.55em; margin-left: -0.10903em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">a</span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.664392em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathit mtight">x</span></span></span></span></span></span></span></span></span></span></span></span><br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">x</span></span></span></span></span> is the number of residues and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathit">m</span></span></span></span></span> is the average number of conformers.<br>
<img src="https://lh3.googleusercontent.com/8Btp6uCNZb5Z-5SU8Ko2zIRX9vd1BX-CKWo8i_EeJ9oKW-XYgZOZuJL8J4ZsPA9Ch9a3b7A6mMjyl8ZCvxw44zJNpUFdfXJrspt05WYxyLGwGau0dcNzddMz3lZXZJWucH_DpYeuGOp6gWlRNyJhwTRp0uE1WAtYJ8EwScEbIwYPcRDBm_TGhj2k1Chm6EsootI5WSxKSCSeoapg1zcAw5X8Q_L9UBneyirt-ejCpPLj8USu3KSh0EcyiCHubQeUdyakv-9MzXdo_Q9CXRmvoc3QAbUSwQ6hVVyU3P_Ao9uyEna5aB7nvbwk7iDkYwCxZf3NapOyLHj0i3ZjpmhiSYrrC2fXYZB0vkoyhQxY-5TkRqu17f-RUXjx0b8L1NVhHJwSydorrEIZOmQuTWN4GzNTb5d3LCnNNgqF_Fd9m4GL5jDsA1Tl_9AyJCZ_hJT2X8CN-wQ5l2CsJtZXmJxPVNMJ7--CMZjofjgJO_WMoCSvG0EDpDssQCFpKseefB2qKCRZ76GTn-07GVEElZkx1VvHVbuyn14EkeT12od9tI_o6ta7tsRjRBrNh7mDuMm0_wP0xY-7Wq_tG3YcGxIJpQvEcCFi1agDSQ3VZSo0HH4cMZEuI_BAsZ87W95sZvXU=w736-h454-no" alt="enter image description here">	<br>
m = 6 in above plot.</p>
<h3 id="sample-space-and-convergence-problem">Sample space and convergence problem</h3>
<p>When sampling number becomes smaller relative to the total number of microstates, the sampling is less representative for the energy landscape. In another word, the sampling result is less likely an accurate one.</p>
<p>This is just one side of the problem. When a few residues are linked, like in proton transfer chain, multi-flipping might not be enough to handle the cocerted motion of 3 or more residues. This will result in trapping of microstate in microscopic terms or fluctuation of occupancy of conformers in macroscopic terms.</p>
<h3 id="entropy">Entropy</h3>
<p>The Monte Carlo sampling itself reflects the entropy effect. Our introduction of entropy is actually remove entropy effect between groups of conformers.</p>
<p>On residue example: A01, A02, A+1 conformers/states</p>
<p>Two ways to overcome this bias:</p>
<ol>
<li>two step sampling</li>
<li>Entropy penelty</li>
</ol>
<p>Entropy is calculted once, and built into the self energy so it is more efficient when calculating energy changes in the sampling, but there is a potential dilemma.  In a big system, how do we know the entropy was sampled correctly? If the entropy was sampled correctly, why don’t we just use the occupancy results from entropy sampling?</p>
<h2 id="script-to-calculate-state-energy-from-a-microstate">Script to calculate state energy from a microstate</h2>
<p>Demo on hestia</p>
<h2 id="what-else-do-we-want-to-know">What else do we want to know?</h2>
<ul>
<li>Microstate energy?</li>
<li>Linked conformation change?</li>
<li>Energy landscape?</li>
</ul>
<h2 id="global-optimization-by-local-equilibrium-sampling-goles">Global Optimization by Local Equilibrium Sampling (GOLES)</h2>
<h3 id="method">Method</h3>
<div class="mermaid"><svg xmlns="http://www.w3.org/2000/svg" id="mermaid-svg-mb1IK5wanrYJSGKG" width="100%" style="max-width: 466.2890625px;" viewBox="0 0 466.2890625 874.3249969482422"><g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M341.07421875,66L341.07421875,91L341.07421875,116" marker-end="url(#arrowhead8104)" style="fill:none"></path><defs><marker id="arrowhead8104" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M341.07421875,162L341.07421875,187L341.07421875,212" marker-end="url(#arrowhead8105)" style="fill:none"></path><defs><marker id="arrowhead8105" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M341.07421875,258L341.07421875,283L341.07421875,308" marker-end="url(#arrowhead8106)" style="fill:none"></path><defs><marker id="arrowhead8106" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M284.2012532552083,354L222.3828125,379L222.3828125,404" marker-end="url(#arrowhead8107)" style="fill:none"></path><defs><marker id="arrowhead8107" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M222.3828125,450L222.3828125,488L222.3828125,526" marker-end="url(#arrowhead8108)" style="fill:none"></path><defs><marker id="arrowhead8108" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M222.3828125,572L222.3828125,597L303.76789393719594,660.3063263386831" marker-end="url(#arrowhead8109)" style="fill:none"></path><defs><marker id="arrowhead8109" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M341.57421875,756.8249984741212L341.07421875,794.3249969482422L341.07421875,832.3249969482422" marker-end="url(#arrowhead8110)" style="fill:none"></path><defs><marker id="arrowhead8110" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M379.380545280664,660.3063250047849L459.765625,597L459.765625,549L459.765625,488L459.765625,427L459.765625,379L397.9471842447917,354" marker-end="url(#arrowhead8111)" style="fill:none"></path><defs><marker id="arrowhead8111" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="" style="opacity: 1;"><g transform="translate(0,0)" class="label"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(341.07421875,794.3249969482422)" style="opacity: 1;"><g transform="translate(-11.8046875,-13)" class="label"><foreignObject width="23.609375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">Yes</span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(459.765625,488)" style="opacity: 1;"><g transform="translate(-10.5234375,-13)" class="label"><foreignObject width="21.046875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">No</span></div></foreignObject></g></g></g><g class="nodes"><g class="node" id="A" transform="translate(341.07421875,43)" style="opacity: 1;"><rect rx="0" ry="0" x="-64.65625" y="-23" width="129.3125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-54.65625,-13)"><foreignObject width="109.3125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Big interactions</div></foreignObject></g></g></g><g class="node" id="B" transform="translate(341.07421875,139)" style="opacity: 1;"><rect rx="0" ry="0" x="-64.0703125" y="-23" width="128.140625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-54.0703125,-13)"><foreignObject width="108.140625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Linked residues</div></foreignObject></g></g></g><g class="node" id="C" transform="translate(341.07421875,235)" style="opacity: 1;"><rect rx="0" ry="0" x="-123.703125" y="-23" width="247.40625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-113.703125,-13)"><foreignObject width="227.40625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Cluster defined by 1 or 2 linkage</div></foreignObject></g></g></g><g class="node" id="D" transform="translate(341.07421875,331)" style="opacity: 1;"><rect rx="0" ry="0" x="-109.6796875" y="-23" width="219.359375" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-99.6796875,-13)"><foreignObject width="199.359375" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Randomize cluster sequence</div></foreignObject></g></g></g><g class="node" id="E" transform="translate(222.3828125,427)" style="opacity: 1;"><rect rx="0" ry="0" x="-202.3828125" y="-23" width="404.765625" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-192.3828125,-13)"><foreignObject width="384.765625" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Sample the cluster either analitically or by Monte Carlo</div></foreignObject></g></g></g><g class="node" id="F" transform="translate(222.3828125,549)" style="opacity: 1;"><rect rx="0" ry="0" x="-144.140625" y="-23" width="288.28125" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-134.140625,-13)"><foreignObject width="268.28125" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Calculate occ and energy convergence</div></foreignObject></g></g></g><g class="node" id="F1" transform="translate(341.07421875,689.1624984741211)" style="opacity: 1;"><polygon points="67.16250000000001,0 134.32500000000002,-67.16250000000001 67.16250000000001,-134.32500000000002 0,-67.16250000000001" rx="5" ry="5" transform="translate(-67.16250000000001,67.16250000000001)"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-41.625,-13)"><foreignObject width="83.25" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Converged?</div></foreignObject></g></g></g><g class="node" id="G" transform="translate(341.07421875,855.3249969482422)" style="opacity: 1;"><rect rx="0" ry="0" x="-23.3984375" y="-23" width="46.796875" height="46"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-13.3984375,-13)"><foreignObject width="26.796875" height="26"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Exit</div></foreignObject></g></g></g></g></g></g></svg></div>
<p>Big interaction -&gt; linked residues -&gt; cluster defined by 1st or 2nd linkage -&gt; sample cluster</p>
<h3 id="benefit">Benefit</h3>
<ul>
<li>
<p>Solve size problem<br>
Since each cluster size is similar, the calculation amount grows in proportion rather than exponentially to the cluster numbers, which is the size of the system, without losing accuracy.<br>
The benefit comes from two aspects, 1) the knowledge of what are important and whar are irrelevant interactions and 2) analytical solution can be used when cluster size is smaller than the threshold.<br>
The cluster method also guarantees hot spots are sampled enough times.</p>
</li>
<li>
<p>Solve memory and speed problem<br>
The pairwise interaction table size increases geometrically as conformer number. While it is not a problem for a system under 10,000 conformers, it will grow hundreds of time bigger when the system is 10 times bigger, while most of the interactions in table are actually 0. With clustered method, the pairwise interaction is stored in a dictionary, leaving out 0s. When sending clusters to sampling subroutine, a fast access dynamic table will be created on the fly.<br>
In clusters, analytical solution speeds up the sampling by not evaluating the same microstate multiple times.</p>
</li>
<li>
<p>Solve concerted multi-flips<br>
A cluster is actually a pool that we can do multi-flips beyond immediate neighbors (current big list flip is limited to this). The first order cluster links three residues and the second order cluster links five residues. High order multi-flips are made possible by the analytical solution or dense sampling in a small cluster.</p>
</li>
<li>
<p>MFE is a special case of this cluster method.</p>
</li>
</ul>
<h3 id="loss">Loss:</h3>
<p>No complete microstate statistics.<br>
Energy is mfe approximation, alought its effectiveness can be measured by locally calculated energy variation and occupancy convergence.</p>
<h2 id="find-linked-conformation-change">Find linked conformation change</h2>
<p>How to see a conformer flip is accompanied by another conformer flip?<br>
Suppose we collected some accessible microstates, in regard to a centered residue and its cluster.<br>
Step 1: Convert to occupancy of conformers. From occupancy, we can know if a conformer flips.<br>
Step 2: Group accessible microstates into groups, each partially conformer has a group.<br>
Step 3. Calculate occupancy for each group.<br>
Step 4. Substract occupancy table between two groups. The differency gives the linked conformation change.</p>
<h2 id="picture-the-energy-landscape">Picture the energy landscape</h2>
<p>Each microstate in a cluster has in-cluster interaction energy and ambient energy (mfe energy). If we plot microstate energy against some variable, we get the energy landscape.</p>
<p>So the question is what variables are meaningful?</p>
<p>One such variable that is easy to calculate and might be meaningful is the cluster dipole. For example, in a proton transfer reaction, it may suggest alternative proton locations and imply a pathway.  The energy should be low on the hydrogen bonded locations and high in the middle locations.</p>
<p>Dipole is calculated by the net charge separation of each microstate and weighted by the microstate population. Since the dipole is a vector in 3D space, we may have to project it to a plane or line. Also the projected plane or line can be color coded to show if a net charge exists.</p>
<p>Unfortunetly, the microstates are limited within a cluster, so how to make a energy landscape cross clusters?</p>

    </div>
  </div>
</body>

</html>
